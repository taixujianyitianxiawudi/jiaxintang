(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{105:function(e,t,n){"use strict";n.r(t);var a,r,c,o,i,s,d,j,l,u,b,O,m,h,x,p=n(64),v=n.n(p),I=(n(83),n(118)),g=n(15),f=n(48),y=n(104),R=n(106),w=n(27),C=new R.a({typePolicies:{Query:{fields:{isLoggedIn:{read:function(){return S()}}}}}}),S=Object(w.c)(!!localStorage.getItem("token")),$=n(7),k=n(29),U=n(119),D=n(116),N=n(1),B=function(){var e=Object(D.a)();return Object(N.jsx)("button",{onClick:function(){e.cache.evict({fieldName:"me"}),e.cache.gc(),localStorage.removeItem("token"),localStorage.removeItem("userId"),S(!1)},children:"log out!"})},P=function(){return Object(N.jsx)("div",{children:"Loading, please wait"})},L=function(){return Object(N.jsx)("div",{children:"Something went wrong!"})},q=Object(k.a)(a||(a=Object($.a)(["\n  query MyProfile {\n    me {\n      id\n      name\n      email\n    }\n  }\n"]))),E=function(){var e=Object(U.a)(q),t=e.data,n=e.loading,a=e.error;return n?Object(N.jsx)(P,{}):a||void 0===t?Object(N.jsx)(L,{}):t.me?Object(N.jsx)("div",{children:Object(N.jsxs)("div",{className:"p-6 max-w-sm mx-auto bg-white rounded-xl shadow-md flex items-center space-x-4",children:[Object(N.jsx)("p",{className:"text-gray-500",children:t.me.id}),Object(N.jsx)("p",{className:"text-gray-500",children:t.me.name}),Object(N.jsx)("p",{className:"text-gray-500",children:t.me.email}),Object(N.jsx)("p",{className:"text-gray-500",children:"My Profile"}),Object(N.jsx)(B,{})]})}):Object(N.jsx)(L,{})},A=n(2),z=n(22),J=n(11),M=n(14),T=n(121),H=Object(k.a)(r||(r=Object($.a)(["\n  mutation SignUp($name: String $email: String! $password: String!) {\n    signup(name: $name email: $email password:$password) {\n      user {\n        id\n        email\n        name\n      }\n      token\n    }\n  }\n"]))),K=function(){var e=Object(T.a)(H,{onCompleted:function(e){var t=e.signup;t&&t.user&&(localStorage.setItem("token",t.token),localStorage.setItem("userId",t.user.id),S(!0))}}),t=Object(M.a)(e,2),n=t[0],a=t[1],r=a.loading,c=a.error,o=Object(A.useState)(""),i=Object(M.a)(o,2),s=i[0],d=i[1],j=Object(A.useState)(""),l=Object(M.a)(j,2),u=l[0],b=l[1],O=Object(A.useState)(""),m=Object(M.a)(O,2),h=m[0],x=m[1];return r?Object(N.jsx)(P,{}):c?Object(N.jsx)("div",{children:"asdfsadf"}):Object(N.jsxs)("div",{children:[Object(N.jsx)("p",{children:"Enter your name, email and password to Signup"}),Object(N.jsx)("input",{placeholder:"name",type:"text",onChange:function(e){return d(e.target.value)}}),Object(N.jsx)("input",{placeholder:"email",type:"text",onChange:function(e){return b(e.target.value)}}),Object(N.jsx)("input",{placeholder:"password",type:"text",onChange:function(e){return x(e.target.value)}}),Object(N.jsx)("button",{onClick:function(){return n({variables:{name:s,email:u,password:h}}).catch((function(e){return"fuck"}))},children:"Signup"})]})},Q=Object(k.a)(c||(c=Object($.a)(["\n  mutation CreateChat($createChatData: CreateChatInput!) {\n    createChat(data: $createChatData) {\n      id\n      content\n    }\n  }\n"]))),V=function(e){var t=e.roomId,n=Object(A.useState)(""),a=Object(M.a)(n,2),r=a[0],c=a[1],o=Object(A.useRef)(null),i=Object(T.a)(Q),s=Object(M.a)(i,1)[0];return Object(N.jsxs)("div",{children:[Object(N.jsx)("textarea",{placeholder:"type your message",onChange:function(e){return c(e.target.value)},onKeyDown:function(e){"Enter"!==e.key||e.shiftKey||null!==o.current&&(s({variables:{createChatData:{roomId:t,content:r}}}).catch((function(e){return"fuck"})),o.current.value="")},ref:o}),Object(N.jsx)("button",{onClick:function(){null!==o.current&&(s({variables:{createChatData:{roomId:t,content:r}}}).catch((function(e){return"fuck"})),o.current.value="")},children:"Enter"})]})},Y=Object(k.a)(o||(o=Object($.a)(["\n  query ChatByRoomIdandUserId(\n    $chatByRoomIdandUserId: Int\n    $chatByRoomIdandUserUserid: Int\n  ) {\n    chatByRoomIdandUser(\n      id: $chatByRoomIdandUserId\n      userid: $chatByRoomIdandUserUserid\n    ) {\n      id\n      createdAt\n      content\n      author {\n        name\n      }\n    }\n  }\n"]))),_=function(e){var t=e.roomId,n=e.userId,a=Object(U.a)(Y,{variables:{chatByRoomIdandUserId:t,chatByRoomIdandUserUserid:n},pollInterval:500}),r=a.data,c=a.loading,o=a.error;return c?Object(N.jsx)(P,{}):o||void 0===r?Object(N.jsx)(L,{}):r?Object(N.jsxs)("div",{children:["PRIVATE ChatHistory here ID:",t,r&&r.chatByRoomIdandUser.map((function(e){var t;return Object(N.jsxs)("div",{children:[Object(N.jsxs)("div",{children:[null===(t=e.author)||void 0===t?void 0:t.name," ",e.createdAt]}),Object(N.jsx)("div",{children:e.content})]},e.id)}))]}):Object(N.jsx)(L,{})},F=Object(k.a)(i||(i=Object($.a)(["\n  query ChatByRoomId($chatByRoomIdId: Int) {\n    chatByRoomId(id: $chatByRoomIdId) {\n      id\n      createdAt\n      content\n      author {\n        name\n      }\n      room {\n        id\n      }\n    }\n  }\n"]))),G=function(e){var t=e.roomId,n=Object(U.a)(F,{variables:{chatByRoomIdId:t},pollInterval:500}),a=n.data,r=n.loading,c=n.error;return r?Object(N.jsx)(P,{}):c||void 0===a?Object(N.jsx)(L,{}):a?Object(N.jsxs)("div",{children:["ChatHistory here ID:",t,a&&a.chatByRoomId.map((function(e){var t;return Object(N.jsxs)("div",{children:[Object(N.jsxs)("div",{children:[null===(t=e.author)||void 0===t?void 0:t.name," ",e.createdAt]}),Object(N.jsx)("div",{children:e.content})]},e.id)}))]}):Object(N.jsx)(L,{})},W=function(e){var t=e.roomId,n=e.userId;return 999999===n?Object(N.jsx)(G,{roomId:t}):Object(N.jsxs)("div",{children:["userID: ",n,Object(N.jsx)(_,{roomId:t,userId:n})]})},X=(Object(k.a)(s||(s=Object($.a)(["\nmutation JoinRooma($incrementRoomUserId: Int!) {\n  incrementRoomUser(id: $incrementRoomUserId) {\n    id\n    name\n  }\n}\n"]))),Object(k.a)(d||(d=Object($.a)(["\nmutation LeftRooma($decrementRoomUserId: Int!) {\n  decrementRoomUser(id: $decrementRoomUserId) {\n    id\n    name\n  }\n}\n"]))),function(e){e._userId;var t=Object(J.f)(),n=t.roomId,a=t.userId;return Object(N.jsxs)("div",{children:[Object(N.jsx)(W,{roomId:parseInt(n,10),userId:parseInt(a,10)}),Object(N.jsxs)("p",{children:["This is a chat room~ ID: ",n]}),Object(N.jsx)(V,{roomId:parseInt(n,10)})]})}),Z=Object(k.a)(j||(j=Object($.a)(["\n  mutation DeleteRoom($deleteRoomId: Int!) {\n    deleteRoom(id: $deleteRoomId) {\n      id\n    }\n  }\n"]))),ee=function(e){var t=e.roomId,n=Object(T.a)(Z),a=Object(M.a)(n,1)[0];return Object(N.jsxs)("button",{onClick:function(){a({variables:{deleteRoomId:t}})},children:["Delete room ",t]})},te=Object(k.a)(l||(l=Object($.a)(["\n  query RoomList {\n    allRooms {\n      currentNumberofUsers\n      name\n      details\n      owner {\n        name\n      }\n      createdAt\n      id\n    }\n  }\n"]))),ne=function(){var e=Object(U.a)(te,{pollInterval:2e3}),t=e.data,n=e.error;return e.loading?Object(N.jsx)(P,{}):n||void 0===t?Object(N.jsx)(L,{}):t?Object(N.jsx)("div",{children:t.allRooms.map((function(e){var t;return Object(N.jsx)(z.b,{to:"/chat/public/"+e.id+"/999999",children:Object(N.jsxs)("div",{className:"p-6 max-w-sm bg-white rounded-xl shadow-md flex items-center space-x-4",children:[Object(N.jsx)("div",{className:"text-gray-500",children:e.id}),Object(N.jsx)("div",{className:"text-gray-500",children:e.name}),Object(N.jsx)("div",{className:"text-gray-500",children:e.details}),Object(N.jsxs)("div",{className:"text-gray-500",children:["this room now have",e.currentNumberofUsers," users"]}),Object(N.jsxs)("div",{className:"text-gray-500",children:["owner: ",null===(t=e.owner)||void 0===t?void 0:t.name]}),Object(N.jsx)(ee,{roomId:e.id},e.id)]})})}))}):Object(N.jsx)(L,{})},ae=Object(k.a)(u||(u=Object($.a)(["\n  query UserPrivateRoom($userPrivateRoomId: Int) {\n  userPrivateRoom(id: $userPrivateRoomId) {\n    id\n  }\n}\n"]))),re=function(e){var t=e.userId,n=Object(U.a)(ae,{variables:{userPrivateRoomId:t}}).data;return n&&n.userPrivateRoom?Object(N.jsx)(z.b,{to:"/chat/private/"+n.userPrivateRoom.id+"/"+t,children:Object(N.jsx)("div",{children:Object(N.jsxs)("p",{children:["This is a chat room~ ID: ",n.userPrivateRoom.id," AND USERID:",t]})})}):Object(N.jsx)(L,{})},ce=Object(k.a)(b||(b=Object($.a)(["\n  query UserList {\n    allUsers {\n      id\n      name\n      isOnline\n    }\n  }\n"]))),oe=function(){var e=Object(U.a)(ce),t=e.data,n=e.loading,a=e.error;return n?Object(N.jsx)(P,{}):a||void 0===t?Object(N.jsx)(L,{}):t?Object(N.jsx)("div",{children:t.allUsers.map((function(e){return Object(N.jsxs)("div",{className:"p-6 max-w-sm mx-auto bg-white rounded-xl shadow-md flex items-center space-x-4",children:[Object(N.jsx)("p",{className:"text-gray-500",children:e.name}),Object(N.jsx)("p",{className:"text-gray-500",children:e.isOnline?Object(N.jsx)("p",{children:"online!"}):Object(N.jsx)("p",{children:"offline"})}),Object(N.jsxs)("button",{children:["Chat with ",e.name]}),Object(N.jsx)(re,{userId:e.id},e.id)]})}))}):Object(N.jsx)(L,{})},ie=Object(k.a)(O||(O=Object($.a)(["\n  mutation CreateRoom($createRoomData: RoomCreateInput!) {\n    createRoom(data: $createRoomData) {\n      id\n    }\n  }\n"]))),se=function(){var e=Object(T.a)(ie),t=Object(M.a)(e,1)[0],n=Object(A.useState)(""),a=Object(M.a)(n,2),r=a[0],c=a[1],o=Object(A.useState)(""),i=Object(M.a)(o,2),s=i[0],d=i[1],j=Object(A.useRef)(null),l=Object(A.useRef)(null);return Object(N.jsxs)("div",{children:[Object(N.jsx)("p",{children:"Enter Room informations"}),Object(N.jsx)("input",{placeholder:"name",type:"text",onChange:function(e){return c(e.target.value)},ref:j}),Object(N.jsx)("input",{placeholder:"details",type:"text",onChange:function(e){return d(e.target.value)},ref:l}),Object(N.jsx)("button",{onClick:function(){null!==j.current&&(t({variables:{createRoomData:{name:r,details:s,public:!0}}}).catch((function(e){return"fuck"})),j.current.value="",null!==l.current&&(l.current.value=""))},children:"CreateRoom"})]})},de=function(){return Object(N.jsx)(z.a,{children:Object(N.jsxs)("div",{children:[Object(N.jsx)("nav",{children:Object(N.jsxs)("ul",{children:[Object(N.jsx)("li",{children:Object(N.jsx)(z.b,{to:"/",children:"Main     You logged in!"})}),Object(N.jsx)("li",{children:Object(N.jsx)(z.b,{to:"/profile",children:"Profile"})}),Object(N.jsx)("li",{children:Object(N.jsx)(z.b,{to:"/signup",children:"Signup"})}),Object(N.jsxs)("li",{children:[Object(N.jsxs)("div",{children:["this is a userlist!",Object(N.jsx)(oe,{})]}),Object(N.jsxs)("div",{children:["this is a room list!",Object(N.jsx)(ne,{})]}),Object(N.jsxs)("div",{children:["create new room here~",Object(N.jsx)(se,{})]})]})]})}),Object(N.jsx)("hr",{}),Object(N.jsxs)(J.c,{children:[Object(N.jsx)(J.a,{exact:!0,path:"/"}),Object(N.jsx)(J.a,{exact:!0,path:"/profile",children:Object(N.jsx)(E,{})}),Object(N.jsx)(J.a,{exact:!0,path:"/signup",children:Object(N.jsx)(K,{})}),Object(N.jsx)(J.a,{path:"/chat/public/:roomId/:userId",exact:!0,children:Object(N.jsx)(X,{})}),Object(N.jsx)(J.a,{path:"/chat/private/:roomId/:userId",exact:!0,children:Object(N.jsx)(X,{})})]})]})})},je=Object(k.a)(m||(m=Object($.a)(["\n  mutation Login($email: String! $password: String!) {\n    login(email: $email password:$password) {\n      user {\n        id\n      }\n      token\n    }\n  }\n"]))),le=function(){var e=Object(T.a)(je,{onCompleted:function(e){var t=e.login;t&&t.user&&(localStorage.setItem("token",t.token),localStorage.setItem("userId",t.user.id),S(!0))}}),t=Object(M.a)(e,2),n=t[0],a=t[1],r=a.loading,c=a.error,o=Object(A.useState)(""),i=Object(M.a)(o,2),s=i[0],d=i[1],j=Object(A.useState)(""),l=Object(M.a)(j,2),u=l[0],b=l[1];return r?Object(N.jsx)(P,{}):c?Object(N.jsx)("div",{children:"asdfsadf"}):Object(N.jsxs)("div",{children:[Object(N.jsx)("p",{children:"Enter your email and password"}),Object(N.jsx)("input",{placeholder:"email",type:"text",onChange:function(e){return d(e.target.value)}}),Object(N.jsx)("input",{placeholder:"password",type:"text",onChange:function(e){return b(e.target.value)}}),Object(N.jsx)("button",{onClick:function(){return n({variables:{email:s,password:u}}).catch((function(e){return"fuck"}))},children:"Login"}),Object(N.jsx)(K,{})]})},ue=Object(k.a)(h||(h=Object($.a)(["\n  extend type Query {\n    isLoggedIn: Boolean!\n  }\n"]))),be=Object(k.a)(x||(x=Object($.a)(["\n  query IsUserLoggedIn {\n    isLoggedIn @client\n  }\n"])));function Oe(){return Object(U.a)(be).data.isLoggedIn?Object(N.jsx)(de,{}):Object(N.jsx)("div",{children:Object(N.jsx)(le,{})})}var me=n(24),he=n(69),xe=new I.a({uri:"http://localhost:4000/graphql",headers:{authorization:localStorage.getItem("token")||"","client-name":"Space Explorer [web]","client-version":"1.0.0"}}),pe=new he.a({uri:"ws://localhost:4000/subscriptions",options:{reconnect:!0,connectionParams:{authorization:localStorage.getItem("token")||""}}}),ve=Object(g.split)((function(e){var t=e.query,n=Object(me.e)(t);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),pe,xe),Ie=new f.a({headers:{authorization:localStorage.getItem("token")||"","client-name":"Space Explorer [web]","client-version":"1.0.0"},cache:C,uri:"http://localhost:4000/graphql",typeDefs:ue,link:ve});v.a.render(Object(N.jsx)(y.a,{client:Ie,children:Object(N.jsx)(Oe,{})}),document.getElementById("root"))},83:function(e,t,n){}},[[105,1,2]]]);
//# sourceMappingURL=main.0fc91e30.chunk.js.map